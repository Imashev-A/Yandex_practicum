# Описание этапа обработки

Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены в крышке ковша. 

Из сплава выводится сера (десульфурация), добавлением примесей корректируется химический состав и отбираются пробы. Сталь легируют — изменяют её состав — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат (англ. tribe, «масса»).

Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.

Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. *slab*, «плита»).

## Описание данных

Данные состоят из файлов, полученных из разных источников:

- `data_arc.csv` — данные об электродах;
- `data_bulk.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas.csv` — данные о продувке сплава газом;
- `data_temp.csv` — результаты измерения температуры;
- `data_wire.csv` — данные о проволочных материалах (объём);
- `data_wire_time.csv` — данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В файлах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.

Задача достигнуть метрики МАЕ < 6.8

## Вывод

Был произведен анализ обработки стали на металлургическом комбинате, для оптимизации производственных расходов путем уменьшения потребления электроэнергии на этапе обработки стали. Стояла задача построения модели, которая предскажет температуру стали. Для решения данной проблемы был разработан план действий по построению модели. В ходе работы были пройдены все пункты плана. Были загружены и изучены данные металлургического комбината. Провели работу с пропусками, были удалены партии без целевого признака (конечной температуры). Остальные пропуски заменены нулями, это пропуски по добавлению сыпучих и проволочных материалов, которые появились из-за того, что не все типы металлов добавлялись сразу в одну партию. Заменили типы данных у некоторых значений. Привели названия столбцов к единому стилю. Построены графики. Подготовили признаки для модели, была рассчитана полная мощность каждой партии в отдельности и время, затраченное на нагрев дугой. Удалены из анализа партии с одним замером температуры. Так же было рассчитано время, затраченное на обработку всей партии.

Была создана таблица с отобранными признаками для прогнозирования и разбита на обучающею и тестовую для моделирования, в соотношении 4 к 1. Было проверено несколько моделей: **DecisionTreeRegressor**, **RandomForestRegressor**, **CatBoostRegressor**, **LGBMRegressor**, **LinearRegression** и **Ridge**. Среди которых лучше себя показала модель **CatBoostRegressor** с параметрами **iterations=450, learning_rate=0.05, max_depth=6, verbose=False**, качество которой было проверено на тестовой выборке и достигнута **МАЕ = 5.36388**, что полностью удовлетворяет условию задачи. Построили график сравнения истинных и предсказанных значений, на котором видно, что модель не плохо определяет конечную температуру партии. 

Провели анализ важности факторов у модели-победителя, как видно основными факторами является начальная температура и полная мощность всей партии. Можно сделать вывод что, управляя стартовой температурой плавления, можно управлять энергозатратами.

## Инструменты:

- matplotlib
- numpy
- pandas
- catboost
- lightgbm
- sklearn
