# Восстановление золота из руды

Подготовьте прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Используйте данные с параметрами добычи и очистки. 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Вам нужно:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.

## Описание данных

**Технологический процесс**
* Rougher feed — исходное сырье
* Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
* Xanthate **— ксантогенат (промотер, или активатор флотации);
* Sulphate — сульфат (на данном производстве сульфид натрия);
* Depressant — депрессант (силикат натрия).
* Rougher process (англ. «грубый процесс») — флотация
* Rougher tails — отвальные хвосты
* Float banks — флотационная установка
* Cleaner process — очистка
* Rougher Au — черновой концентрат золота
* Final Au — финальный концентрат золота

**Параметры этапов**
* air amount — объём воздуха
* fluid levels — уровень жидкости
* feed size — размер гранул сырья
* feed rate — скорость подачи

**Наименование признаков**

Наименование признаков должно быть такое:

`[этап].[тип_параметра].[название_параметра]`

Пример: `rougher.input.feed_ag`

Возможные значения для блока `[этап]`:
* rougher — флотация
* primary_cleaner — первичная очистка
* secondary_cleaner — вторичная очистка
* final — финальные характеристики

Возможные значения для блока `[тип_параметра]`:
* input — параметры сырья
* output — параметры продукта
* state — параметры, характеризующие текущее состояние этапа
* calculation — расчётные характеристики

## Вывод

Проверили, что эффективность обогащения рассчитана правильна. Удалили признаки, которые не понадобятся при обучении моделей. Заменили пропуски данными из предыдущих ячеек, т.к. по условию задачи соседние по времени параметры часто похожи.

Провели анализ изменения сырья после этапов очистки и суммарной концентрации веществ.

Обучили разные модели и оцените их качество кросс-валидацией метрикой smape. Лучшая метрика у модели случайный лес и оставляет 8.93. Лучшей моделью эффективности обогащения чернового концентрата, является RandomForestRegressor(max_depth=5, n_estimators=10, random_state=12345) и финального концентрата - RandomForestRegressor(max_depth=1, n_estimators=20, random_state=12345)

Проверили модель на адекватность с помощью DummyRegressor на средних значениях и получили метрику 9.38, что больше чем на нашей модели.

## Инструменты:

- matplotlib
- numpy
- pandas
- sklearn
